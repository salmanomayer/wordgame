(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,67881,e=>{"use strict";var t=e.i(43476),a=e.i(91918),r=e.i(25913),s=e.i(47163);let l=(0,r.cva)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9","icon-sm":"size-8","icon-lg":"size-10"}},defaultVariants:{variant:"default",size:"default"}});function n({className:e,variant:r,size:n,asChild:i=!1,...o}){let d=i?a.Slot:"button";return(0,t.jsx)(d,{"data-slot":"button",className:(0,s.cn)(l({variant:r,size:n,className:e})),...o})}e.s(["Button",()=>n])},70065,e=>{"use strict";var t=e.i(43476),a=e.i(47163);function r({className:e,...r}){return(0,t.jsx)("div",{"data-slot":"card",className:(0,a.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...r})}function s({className:e,...r}){return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,a.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...r})}function l({className:e,...r}){return(0,t.jsx)("div",{"data-slot":"card-title",className:(0,a.cn)("leading-none font-semibold",e),...r})}function n({className:e,...r}){return(0,t.jsx)("div",{"data-slot":"card-description",className:(0,a.cn)("text-muted-foreground text-sm",e),...r})}function i({className:e,...r}){return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,a.cn)("px-6",e),...r})}e.s(["Card",()=>r,"CardContent",()=>i,"CardDescription",()=>n,"CardHeader",()=>s,"CardTitle",()=>l])},64030,e=>{"use strict";let t=(0,e.i(75254).default)("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);e.s(["Trophy",()=>t],64030)},71689,e=>{"use strict";let t=(0,e.i(75254).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],71689)},31343,e=>{"use strict";let t=(0,e.i(75254).default)("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);e.s(["Play",()=>t],31343)},87336,e=>{"use strict";var t=e.i(43476),a=e.i(71645),r=e.i(30030),s=e.i(48425),l="Progress",[n,i]=(0,r.createContextScope)(l),[o,d]=n(l),c=a.forwardRef((e,a)=>{var r,l;let{__scopeProgress:n,value:i=null,max:d,getValueLabel:c=u,...m}=e;(d||0===d)&&!g(d)&&console.error((r=`${d}`,`Invalid prop \`max\` of value \`${r}\` supplied to \`Progress\`. Only numbers greater than 0 are valid max values. Defaulting to \`100\`.`));let h=g(d)?d:100;null===i||p(i,h)||console.error((l=`${i}`,`Invalid prop \`value\` of value \`${l}\` supplied to \`Progress\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or 100 if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`));let b=p(i,h)?i:null,v=x(b)?c(b,h):void 0;return(0,t.jsx)(o,{scope:n,value:b,max:h,children:(0,t.jsx)(s.Primitive.div,{"aria-valuemax":h,"aria-valuemin":0,"aria-valuenow":x(b)?b:void 0,"aria-valuetext":v,role:"progressbar","data-state":f(b,h),"data-value":b??void 0,"data-max":h,...m,ref:a})})});c.displayName=l;var m="ProgressIndicator",h=a.forwardRef((e,a)=>{let{__scopeProgress:r,...l}=e,n=d(m,r);return(0,t.jsx)(s.Primitive.div,{"data-state":f(n.value,n.max),"data-value":n.value??void 0,"data-max":n.max,...l,ref:a})});function u(e,t){return`${Math.round(e/t*100)}%`}function f(e,t){return null==e?"indeterminate":e===t?"complete":"loading"}function x(e){return"number"==typeof e}function g(e){return x(e)&&!isNaN(e)&&e>0}function p(e,t){return x(e)&&!isNaN(e)&&e<=t&&e>=0}h.displayName=m;var b=e.i(47163);function v({className:e,value:a,...r}){return(0,t.jsx)(c,{"data-slot":"progress",className:(0,b.cn)("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",e),...r,children:(0,t.jsx)(h,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:`translateX(-${100-(a||0)}%)`}})})}e.s(["Progress",()=>v],87336)},17835,e=>{"use strict";let t=(0,e.i(75254).default)("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);e.s(["Timer",()=>t],17835)},41240,e=>{"use strict";let t=(0,e.i(75254).default)("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);e.s(["Lightbulb",()=>t],41240)},59133,e=>{"use strict";var t={};!function e(t,a,r,s){var l,n,i,o,d,c,m,h,u,f,x,g=!!(t.Worker&&t.Blob&&t.Promise&&t.OffscreenCanvas&&t.OffscreenCanvasRenderingContext2D&&t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype.transferControlToOffscreen&&t.URL&&t.URL.createObjectURL),p="function"==typeof Path2D&&"function"==typeof DOMMatrix;function b(){}function v(e){var r=a.exports.Promise,s=void 0!==r?r:t.Promise;return"function"==typeof s?new s(e):(e(b,b),null)}var y=(l=function(){if(!t.OffscreenCanvas)return!1;try{var e=new OffscreenCanvas(1,1),a=e.getContext("2d");a.fillRect(0,0,1,1);var r=e.transferToImageBitmap();a.createPattern(r,"no-repeat")}catch(e){return!1}return!0}(),n=new Map,{transform:function(e){if(l)return e;if(n.has(e))return n.get(e);var t=new OffscreenCanvas(e.width,e.height);return t.getContext("2d").drawImage(e,0,0),n.set(e,t),t},clear:function(){n.clear()}}),w=(d=Math.floor(1e3/60),c={},m=0,"function"==typeof requestAnimationFrame&&"function"==typeof cancelAnimationFrame?(i=function(e){var t=Math.random();return c[t]=requestAnimationFrame(function a(r){m===r||m+d-1<r?(m=r,delete c[t],e()):c[t]=requestAnimationFrame(a)}),t},o=function(e){c[e]&&cancelAnimationFrame(c[e])}):(i=function(e){return setTimeout(e,d)},o=function(e){return clearTimeout(e)}),{frame:i,cancel:o}),j=(f={},function(){if(h)return h;if(!r&&g){var t=["var CONFETTI, SIZE = {}, module = {};","("+e.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {\n  if (msg.data.options) {\n    CONFETTI(msg.data.options).then(function () {\n      if (msg.data.callback) {\n        postMessage({ callback: msg.data.callback });\n      }\n    });\n  } else if (msg.data.reset) {\n    CONFETTI && CONFETTI.reset();\n  } else if (msg.data.resize) {\n    SIZE.width = msg.data.resize.width;\n    SIZE.height = msg.data.resize.height;\n  } else if (msg.data.canvas) {\n    SIZE.width = msg.data.canvas.width;\n    SIZE.height = msg.data.canvas.height;\n    CONFETTI = module.exports.create(msg.data.canvas);\n  }\n}"].join("\n");try{h=new Worker(URL.createObjectURL(new Blob([t])))}catch(e){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn("ðŸŽŠ Could not load worker",e),null}var a=h;function s(e,t){a.postMessage({options:e||{},callback:t})}a.init=function(e){var t=e.transferControlToOffscreen();a.postMessage({canvas:t},[t])},a.fire=function(e,t,r){if(u)return s(e,null),u;var l=Math.random().toString(36).slice(2);return u=v(function(t){function n(e){e.data.callback===l&&(delete f[l],a.removeEventListener("message",n),u=null,y.clear(),r(),t())}a.addEventListener("message",n),s(e,l),f[l]=n.bind(null,{data:{callback:l}})})},a.reset=function(){for(var e in a.postMessage({reset:!0}),f)f[e](),delete f[e]}}return h}),N={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function M(e,t,a){var r;return r=e&&null!=e[t]?e[t]:N[t],a?a(r):r}function C(e){return e<0?0:Math.floor(e)}function k(e){return parseInt(e,16)}function P(e){return e.map(S)}function S(e){var t=String(e).replace(/[^0-9a-f]/gi,"");return t.length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),{r:k(t.substring(0,2)),g:k(t.substring(2,4)),b:k(t.substring(4,6))}}function T(e){e.width=document.documentElement.clientWidth,e.height=document.documentElement.clientHeight}function I(e){var t=e.getBoundingClientRect();e.width=t.width,e.height=t.height}function A(e,a){var l,n=!e,i=!!M(a||{},"resize"),o=!1,d=M(a,"disableForReducedMotion",Boolean),c=g&&M(a||{},"useWorker")?j():null,m=n?T:I,h=!!e&&!!c&&!!e.__confetti_initialized,u="function"==typeof matchMedia&&matchMedia("(prefers-reduced-motion)").matches;function f(a){var f,x=d||M(a,"disableForReducedMotion",Boolean),g=M(a,"zIndex",Number);if(x&&u)return v(function(e){e()});n&&l?e=l.canvas:n&&!e&&((f=document.createElement("canvas")).style.position="fixed",f.style.top="0px",f.style.left="0px",f.style.pointerEvents="none",f.style.zIndex=g,e=f,document.body.appendChild(e)),i&&!h&&m(e);var b={width:e.width,height:e.height};function j(){if(c){var t={getBoundingClientRect:function(){if(!n)return e.getBoundingClientRect()}};m(t),c.postMessage({resize:{width:t.width,height:t.height}});return}b.width=b.height=null}function N(){l=null,i&&(o=!1,t.removeEventListener("resize",j)),n&&e&&(document.body.contains(e)&&document.body.removeChild(e),e=null,h=!1)}return(c&&!h&&c.init(e),h=!0,c&&(e.__confetti_initialized=!0),i&&!o&&(o=!0,t.addEventListener("resize",j,!1)),c)?c.fire(a,b,N):function(t,a,n){for(var i,o,d,c,h,u,f,x=M(t,"particleCount",C),g=M(t,"angle",Number),b=M(t,"spread",Number),j=M(t,"startVelocity",Number),N=M(t,"decay",Number),k=M(t,"gravity",Number),S=M(t,"drift",Number),T=M(t,"colors",P),I=M(t,"ticks",Number),A=M(t,"shapes"),_=M(t,"scalar"),B=!!M(t,"flat"),R=((i=M(t,"origin",Object)).x=M(i,"x",Number),i.y=M(i,"y",Number),i),z=x,O=[],E=e.width*R.x,L=e.height*R.y;z--;)O.push(function(e){var t=e.angle*(Math.PI/180),a=e.spread*(Math.PI/180);return{x:e.x,y:e.y,wobble:10*Math.random(),wobbleSpeed:Math.min(.11,.1*Math.random()+.05),velocity:.5*e.startVelocity+Math.random()*e.startVelocity,angle2D:-t+(.5*a-Math.random()*a),tiltAngle:(.5*Math.random()+.25)*Math.PI,color:e.color,shape:e.shape,tick:0,totalTicks:e.ticks,decay:e.decay,drift:e.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:3*e.gravity,ovalScalar:.6,scalar:e.scalar,flat:e.flat}}({x:E,y:L,angle:g,spread:b,startVelocity:j,color:T[z%T.length],shape:A[Math.floor(Math.random()*(A.length-0))+0],ticks:I,decay:N,gravity:k,drift:S,scalar:_,flat:B}));return l?l.addFettis(O):(o=e,h=O.slice(),u=o.getContext("2d"),f=v(function(e){function t(){d=c=null,u.clearRect(0,0,a.width,a.height),y.clear(),n(),e()}d=w.frame(function e(){r&&(a.width!==s.width||a.height!==s.height)&&(a.width=o.width=s.width,a.height=o.height=s.height),a.width||a.height||(m(o),a.width=o.width,a.height=o.height),u.clearRect(0,0,a.width,a.height),(h=h.filter(function(e){return function(e,t){t.x+=Math.cos(t.angle2D)*t.velocity+t.drift,t.y+=Math.sin(t.angle2D)*t.velocity+t.gravity,t.velocity*=t.decay,t.flat?(t.wobble=0,t.wobbleX=t.x+10*t.scalar,t.wobbleY=t.y+10*t.scalar,t.tiltSin=0,t.tiltCos=0,t.random=1):(t.wobble+=t.wobbleSpeed,t.wobbleX=t.x+10*t.scalar*Math.cos(t.wobble),t.wobbleY=t.y+10*t.scalar*Math.sin(t.wobble),t.tiltAngle+=.1,t.tiltSin=Math.sin(t.tiltAngle),t.tiltCos=Math.cos(t.tiltAngle),t.random=Math.random()+2);var a,r,s,l,n,i,o,d,c,m,h,u,f,x,g,b,v=t.tick++/t.totalTicks,w=t.x+t.random*t.tiltCos,j=t.y+t.random*t.tiltSin,N=t.wobbleX+t.random*t.tiltCos,M=t.wobbleY+t.random*t.tiltSin;if(e.fillStyle="rgba("+t.color.r+", "+t.color.g+", "+t.color.b+", "+(1-v)+")",e.beginPath(),p&&"path"===t.shape.type&&"string"==typeof t.shape.path&&Array.isArray(t.shape.matrix)){e.fill((a=t.shape.path,r=t.shape.matrix,s=t.x,l=t.y,n=.1*Math.abs(N-w),i=.1*Math.abs(M-j),o=Math.PI/10*t.wobble,d=new Path2D(a),(c=new Path2D).addPath(d,new DOMMatrix(r)),(m=new Path2D).addPath(c,new DOMMatrix([Math.cos(o)*n,Math.sin(o)*n,-Math.sin(o)*i,Math.cos(o)*i,s,l])),m))}else if("bitmap"===t.shape.type){var C=Math.PI/10*t.wobble,k=.1*Math.abs(N-w),P=.1*Math.abs(M-j),S=t.shape.bitmap.width*t.scalar,T=t.shape.bitmap.height*t.scalar,I=new DOMMatrix([Math.cos(C)*k,Math.sin(C)*k,-Math.sin(C)*P,Math.cos(C)*P,t.x,t.y]);I.multiplySelf(new DOMMatrix(t.shape.matrix));var A=e.createPattern(y.transform(t.shape.bitmap),"no-repeat");A.setTransform(I),e.globalAlpha=1-v,e.fillStyle=A,e.fillRect(t.x-S/2,t.y-T/2,S,T),e.globalAlpha=1}else if("circle"===t.shape)e.ellipse?e.ellipse(t.x,t.y,Math.abs(N-w)*t.ovalScalar,Math.abs(M-j)*t.ovalScalar,Math.PI/10*t.wobble,0,2*Math.PI):(h=t.x,u=t.y,f=Math.abs(N-w)*t.ovalScalar,x=Math.abs(M-j)*t.ovalScalar,g=Math.PI/10*t.wobble,b=2*Math.PI,e.save(),e.translate(h,u),e.rotate(g),e.scale(f,x),e.arc(0,0,1,0,b,void 0),e.restore());else if("star"===t.shape)for(var _=Math.PI/2*3,B=4*t.scalar,R=8*t.scalar,z=t.x,O=t.y,E=5,L=Math.PI/5;E--;)z=t.x+Math.cos(_)*R,O=t.y+Math.sin(_)*R,e.lineTo(z,O),_+=L,z=t.x+Math.cos(_)*B,O=t.y+Math.sin(_)*B,e.lineTo(z,O),_+=L;else e.moveTo(Math.floor(t.x),Math.floor(t.y)),e.lineTo(Math.floor(t.wobbleX),Math.floor(j)),e.lineTo(Math.floor(N),Math.floor(M)),e.lineTo(Math.floor(w),Math.floor(t.wobbleY));return e.closePath(),e.fill(),t.tick<t.totalTicks}(u,e)})).length?d=w.frame(e):t()}),c=t}),(l={addFettis:function(e){return h=h.concat(e),f},canvas:o,promise:f,reset:function(){d&&w.cancel(d),c&&c()}}).promise)}(a,b,N)}return f.reset=function(){c&&c.reset(),l&&l.reset()},f}function _(){return x||(x=A(null,{useWorker:!0,resize:!0})),x}a.exports=function(){return _().apply(this,arguments)},a.exports.reset=function(){_().reset()},a.exports.create=A,a.exports.shapeFromPath=function(e){if(!p)throw Error("path confetti are not supported in this browser");"string"==typeof e?r=e:(r=e.path,s=e.matrix);var t=new Path2D(r),a=document.createElement("canvas").getContext("2d");if(!s){for(var r,s,l,n,i=1e3,o=1e3,d=0,c=0,m=0;m<1e3;m+=2)for(var h=0;h<1e3;h+=2)a.isPointInPath(t,m,h,"nonzero")&&(i=Math.min(i,m),o=Math.min(o,h),d=Math.max(d,m),c=Math.max(c,h));l=d-i;var u=Math.min(10/l,10/(n=c-o));s=[u,0,0,u,-Math.round(l/2+i)*u,-Math.round(n/2+o)*u]}return{type:"path",path:r,matrix:s}},a.exports.shapeFromText=function(e){var t,a=1,r="#000000",s='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';"string"==typeof e?t=e:(t=e.text,a="scalar"in e?e.scalar:a,s="fontFamily"in e?e.fontFamily:s,r="color"in e?e.color:r);var l=10*a,n=""+l+"px "+s,i=new OffscreenCanvas(l,l),o=i.getContext("2d");o.font=n;var d=o.measureText(t),c=Math.ceil(d.actualBoundingBoxRight+d.actualBoundingBoxLeft),m=Math.ceil(d.actualBoundingBoxAscent+d.actualBoundingBoxDescent),h=d.actualBoundingBoxLeft+2,u=d.actualBoundingBoxAscent+2;c+=4,m+=4,(o=(i=new OffscreenCanvas(c,m)).getContext("2d")).font=n,o.fillStyle=r,o.fillText(t,h,u);var f=1/a;return{type:"bitmap",bitmap:i.transferToImageBitmap(),matrix:[f,0,0,f,-c*f/2,-m*f/2]}}}(function(){return"undefined"!=typeof window?window:"undefined"!=typeof self?self:this||{}}(),t,!1);let a=t.exports;t.exports.create,e.s(["default",0,a])},88081,e=>{"use strict";let t=(0,e.i(75254).default)("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);e.s(["Hash",()=>t],88081)},79486,e=>{"use strict";var t=e.i(43476),a=e.i(71645),r=e.i(18566),s=e.i(67881),l=e.i(70065),n=e.i(87336),i=e.i(71689),o=e.i(17835),d=e.i(88081),c=e.i(64030),m=e.i(41240),h=e.i(31343),u=e.i(59133);let f=e=>{(0,u.default)("small"===e?{particleCount:100,spread:70}:{particleCount:200,spread:100})};function x(){let e=(0,r.useParams)(),u=e?.id,[x,g]=(0,a.useState)([]),[p,b]=(0,a.useState)(0),[v,y]=(0,a.useState)(0),[w,j]=(0,a.useState)(null),[N,M]=(0,a.useState)(!1),[C,k]=(0,a.useState)(null),[P,S]=(0,a.useState)(!1),[T,I]=(0,a.useState)(0),A=(()=>{if(!u)return 0;let e=0;for(let t=0;t<u.length;t++)e=(31*e+u.charCodeAt(t))%1e3;return e})(),[_,B]=(0,a.useState)("easy"),[R,z]=(0,a.useState)(!1),[O,E]=(0,a.useState)(null),[L,F]=(0,a.useState)(null),[D,Z]=(0,a.useState)(null),[G,H]=(0,a.useState)(null),U=(0,r.useRouter)(),[$,Y]=(0,a.useState)("");(0,a.useEffect)(()=>{(async()=>{try{if(console.log("[v0] Starting game initialization for session:",u),!u||"undefined"===u){console.error("[v0] Invalid session ID:",u),alert("Invalid game session. Please start a new game from the dashboard."),U.push("/play/dashboard");return}let e=await fetch("/api/auth/me");if(!e.ok){alert("You must be logged in to play. Redirecting to login..."),U.push("/play/login");return}let t=await e.json().catch(()=>null),a=t?.player;if(!a)return void U.push("/play/login");if(!a.is_active){alert("Your account is not active. Please contact support."),U.push("/play/login");return}let r=await fetch(`/api/game/session/${encodeURIComponent(u)}`),s=await r.json().catch(()=>null);if(!r.ok){alert(s?.error||"Game session not found. Please start a new game from the dashboard."),U.push("/play/dashboard");return}let l=s?.session??s;if(!l)return void U.push("/play/dashboard");if(console.log("[v0] Game session found and verified:",l),j(l.id),Y(l.subject_id),B(l.difficulty),E(l.game_id),l.game_id&&l.stage_id){let e=await fetch(`/api/player/game/${l.game_id}/progress`),t=await e.json().catch(()=>null);if(t&&t.stages){let e=t.stages.find(e=>e.id===l.stage_id);e&&H(e.title)}}let n=new URLSearchParams({subject_id:String(l.subject_id)}),i=await fetch(`/api/words?${n.toString()}`),o=await i.json().catch(()=>[]);if(console.log("[v0] Fetched words:",Array.isArray(o)?o.length:0),!Array.isArray(o)||o.length<5){alert("Not enough words in this category"),U.push("/play/dashboard");return}let d=o.slice().sort(()=>Math.random()-.5).slice(0,5).map(e=>({...e,...function(e,t){let a=e.toUpperCase(),r="easy"===t?1:"medium"===t?2:3;console.log("[v0] Generating puzzle for:",a,"difficulty:",t,"gaps:",r);let s=[];for(;s.length<Math.min(r,a.length);){let e=Math.floor(Math.random()*a.length);s.includes(e)||s.push(e)}let l=s.sort((e,t)=>e-t),n=l.map(e=>a[e]).join("");console.log("[v0] Missing indices:",l,"Correct letters:",n);let i="ABCDEFGHIJKLMNOPQRSTUVWXYZ",o=[];for(;o.length<3;){let e="";for(let t=0;t<r;t++)e+=i[Math.floor(Math.random()*i.length)];e===n||o.includes(e)||o.push(e)}let d=[n,...o].sort(()=>Math.random()-.5);return console.log("[v0] Generated options:",d),{missingIndex:l,options:d}}(e.word,l.difficulty)}));g(d),console.log("[v0] Game initialized successfully with",d.length,"words")}catch(e){console.error("[v0] Unexpected error during game init:",e),alert("An error occurred. Please try again."),U.push("/play/dashboard")}})()},[u,U]),(0,a.useEffect)(()=>{if(R&&!N&&x.length>0){let e=setInterval(()=>I(e=>e+1),1e3);return()=>clearInterval(e)}},[R,N,x]);let J=async e=>{if(C)return;let t=x[p],a=t.missingIndex.map(e=>t.word[e]).join("").toUpperCase(),r=e.toUpperCase()===a;if(r?(y(v+10),k("correct"),f("small")):k("wrong"),w)try{await fetch("/api/game/submit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:w,word_id:t.id,is_correct:r,time_taken:T})})}catch(e){console.error("[v0] Failed to save answer:",e)}setTimeout(()=>{p<x.length-1?(b(p+1),k(null),S(!1)):W(r?v+10:v)},r?1500:500)},W=async e=>{if(w)try{if(await fetch("/api/game/complete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:w,score:e,words_completed:x.length})}),O){let t=await fetch(`/api/player/game/${O}/progress`),a=await t.json().catch(()=>null);if(a&&a.next_stage_id){if(F(a.next_stage_id),a.stages){let e=a.stages.find(e=>e.id===a.next_stage_id);Z(e?.title||"Next Stage")}M(!0),f("small")}else if(M(!0),f("large"),50===e){let e=setInterval(()=>f("small"),1e3);setTimeout(()=>clearInterval(e),5e3)}}else if(M(!0),f("large"),50===e){let e=setInterval(()=>f("small"),1e3);setTimeout(()=>clearInterval(e),5e3)}}catch(e){console.error("[v0] Failed to complete game:",e),M(!0)}};if(0===x.length)return(0,t.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-gradient-to-br from-slate-950 via-slate-950 to-slate-950",children:(0,t.jsx)("div",{className:"text-lg text-white",children:"Loading game..."})});if(!R&&x.length>0)return(0,t.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-gradient-to-br from-emerald-900 via-teal-800 to-blue-900 p-4 sm:p-6",children:(0,t.jsxs)(l.Card,{className:"relative w-full max-w-lg bg-gradient-to-b from-slate-900/95 to-slate-950/95 backdrop-blur-xl border border-emerald-500/30 text-white shadow-2xl shadow-emerald-500/10 overflow-hidden",children:[(0,t.jsx)("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-emerald-500 via-teal-400 to-cyan-500"}),(0,t.jsxs)(l.CardHeader,{className:"text-center pt-8 pb-4",children:[(0,t.jsx)("div",{className:"flex justify-center mb-6",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-emerald-400/30 rounded-full blur-2xl scale-150 animate-pulse"}),(0,t.jsx)("div",{className:"relative bg-gradient-to-b from-emerald-300 to-emerald-500 rounded-full p-4 shadow-lg shadow-emerald-500/50",children:(0,t.jsx)(h.Play,{className:"w-16 h-16 sm:w-20 sm:h-20 text-emerald-900 ml-2"})})]})}),(0,t.jsx)(l.CardTitle,{className:"text-2xl sm:text-3xl font-bold bg-gradient-to-r from-emerald-300 via-teal-200 to-cyan-300 bg-clip-text text-transparent mb-2",children:G||"Ready to Play?"}),(0,t.jsxs)("p",{className:"text-slate-400 text-sm sm:text-base",children:["Game #",A]})]}),(0,t.jsxs)(l.CardContent,{className:"text-center space-y-6 px-6 pb-8",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"bg-slate-800/60 backdrop-blur rounded-xl p-4 border border-slate-700/50",children:[(0,t.jsx)("div",{className:"text-xl font-bold text-emerald-400 capitalize",children:_}),(0,t.jsx)("p",{className:"text-slate-400 text-xs mt-1",children:"Difficulty"})]}),(0,t.jsxs)("div",{className:"bg-slate-800/60 backdrop-blur rounded-xl p-4 border border-slate-700/50",children:[(0,t.jsx)("div",{className:"text-xl font-bold text-cyan-400",children:x.length}),(0,t.jsx)("p",{className:"text-slate-400 text-xs mt-1",children:"Words"})]})]}),(0,t.jsx)(s.Button,{className:"w-full bg-gradient-to-r from-emerald-500 via-teal-500 to-cyan-500 hover:from-emerald-600 hover:via-teal-600 hover:to-cyan-600 text-white font-bold py-6 text-lg rounded-xl shadow-lg shadow-emerald-500/30 transition-all duration-300 hover:scale-[1.02]",onClick:()=>z(!0),children:"Start Game"}),(0,t.jsx)(s.Button,{variant:"ghost",className:"w-full text-slate-400 hover:text-white",onClick:()=>U.push("/play/dashboard"),children:"Cancel"})]})]})});if(N){let e,a,r=50===v,n=["Outstanding Performance!","You're a Word Master!","Brilliant Work!","Exceptional Skills!","Phenomenal Achievement!"],i=n[A%n.length],o=Math.round(v/50*100);return(0,t.jsxs)("div",{className:"flex min-h-screen items-center justify-center bg-gradient-to-br from-slate-950 via-emerald-950 to-teal-950 p-4 sm:p-6 overflow-hidden",children:[(0,t.jsxs)("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[(0,t.jsx)("div",{className:"absolute top-1/4 left-1/4 w-96 h-96 bg-emerald-500/10 rounded-full blur-3xl animate-pulse"}),(0,t.jsx)("div",{className:"absolute bottom-1/4 right-1/4 w-96 h-96 bg-teal-500/10 rounded-full blur-3xl animate-pulse delay-1000"}),(0,t.jsx)("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px] bg-cyan-500/5 rounded-full blur-3xl"})]}),(0,t.jsxs)(l.Card,{className:"relative w-full max-w-lg bg-gradient-to-b from-slate-900/95 to-slate-950/95 backdrop-blur-xl border border-emerald-500/30 text-white shadow-2xl shadow-emerald-500/10 overflow-hidden",children:[(0,t.jsx)("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-emerald-500 via-teal-400 to-cyan-500"}),(0,t.jsxs)(l.CardHeader,{className:"text-center pt-8 pb-4",children:[(0,t.jsx)("div",{className:"flex justify-center mb-6",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-yellow-400/30 rounded-full blur-2xl scale-150 animate-pulse"}),(0,t.jsx)("div",{className:"relative bg-gradient-to-b from-yellow-300 to-yellow-500 rounded-full p-4 shadow-lg shadow-yellow-500/50",children:(0,t.jsx)(c.Trophy,{className:"w-16 h-16 sm:w-20 sm:h-20 text-yellow-900"})}),r&&(0,t.jsx)("div",{className:"absolute -top-2 -right-2 bg-gradient-to-r from-pink-500 to-rose-500 rounded-full px-2 py-1 text-xs font-bold animate-bounce",children:"PERFECT!"})]})}),(0,t.jsx)(l.CardTitle,{className:"text-2xl sm:text-3xl font-bold bg-gradient-to-r from-emerald-300 via-teal-200 to-cyan-300 bg-clip-text text-transparent mb-2",children:L?"Stage Complete!":i}),(0,t.jsx)("p",{className:"text-slate-400 text-sm sm:text-base",children:L?"Great job! Ready for the next challenge?":"Game Complete!"})]}),(0,t.jsxs)(l.CardContent,{className:"text-center space-y-6 px-6 pb-8",children:[(0,t.jsxs)("div",{className:"relative bg-gradient-to-br from-emerald-600 via-emerald-500 to-teal-600 rounded-2xl p-6 shadow-lg shadow-emerald-500/30 overflow-hidden",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA2MCA2MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxnIGZpbGw9IiNmZmYiIGZpbGwtb3BhY2l0eT0iMC4xIj48cGF0aCBkPSJNMzYgMzRoLTJ2LTRoMnY0em0wLTZ2LTRoLTJ2NGgyem0tNiA2aC00djJoNHYtMnptMC02djRoLTR2LTJoMnYtMmgyem0tNi02di0yaDR2LTJoLTR2MmgtMnYyaDJ6Ii8+PC9nPjwvZz48L3N2Zz4=')] opacity-30"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"text-6xl sm:text-7xl font-black text-white mb-1 drop-shadow-lg",children:v}),(0,t.jsx)("p",{className:"text-emerald-100 font-medium text-sm sm:text-base uppercase tracking-wider",children:"Total Points"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,t.jsxs)("div",{className:"bg-slate-800/60 backdrop-blur rounded-xl p-4 border border-slate-700/50 hover:border-emerald-500/50 transition-colors",children:[(0,t.jsxs)("div",{className:"text-xl sm:text-2xl font-bold text-emerald-400",children:[Math.floor(v/10),"/5"]}),(0,t.jsx)("p",{className:"text-slate-400 text-xs sm:text-sm mt-1",children:"Correct"})]}),(0,t.jsxs)("div",{className:"bg-slate-800/60 backdrop-blur rounded-xl p-4 border border-slate-700/50 hover:border-teal-500/50 transition-colors",children:[(0,t.jsx)("div",{className:"text-xl sm:text-2xl font-bold text-teal-400 capitalize",children:_}),(0,t.jsx)("p",{className:"text-slate-400 text-xs sm:text-sm mt-1",children:"Difficulty"})]}),(0,t.jsxs)("div",{className:"bg-slate-800/60 backdrop-blur rounded-xl p-4 border border-slate-700/50 hover:border-cyan-500/50 transition-colors",children:[(0,t.jsx)("div",{className:"text-xl sm:text-2xl font-bold text-cyan-400",children:(e=Math.floor(T/60),a=T%60,e>0?`${e}m ${a}s`:`${a}s`)}),(0,t.jsx)("p",{className:"text-slate-400 text-xs sm:text-sm mt-1",children:"Time"})]})]}),(0,t.jsxs)("div",{className:"bg-slate-800/40 rounded-xl p-4 border border-slate-700/50",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,t.jsx)("span",{className:"text-slate-400 text-sm",children:"Accuracy"}),(0,t.jsxs)("span",{className:"text-emerald-400 font-bold",children:[o,"%"]})]}),(0,t.jsx)("div",{className:"h-3 bg-slate-700/50 rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:"h-full bg-gradient-to-r from-emerald-500 to-teal-400 rounded-full transition-all duration-1000 ease-out",style:{width:`${o}%`}})})]}),r&&(0,t.jsxs)("div",{className:"bg-gradient-to-r from-yellow-500/20 to-amber-500/20 border border-yellow-500/40 rounded-xl p-4 backdrop-blur",children:[(0,t.jsx)("p",{className:"text-yellow-300 font-bold text-lg",children:"Perfect Score!"}),(0,t.jsx)("p",{className:"text-yellow-200/80 text-sm",children:"You got every word right!"})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-3 pt-2",children:[(0,t.jsxs)(s.Button,{className:"w-full bg-gradient-to-r from-emerald-500 via-teal-500 to-cyan-500 hover:from-emerald-600 hover:via-teal-600 hover:to-cyan-600 text-white font-bold py-6 text-lg rounded-xl shadow-lg shadow-emerald-500/30 transition-all duration-300 hover:scale-[1.02] hover:shadow-emerald-500/50",onClick:async()=>{try{if(L){let e=await fetch("/api/game/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({game_id:O,stage_id:L,is_demo:!1})}),t=await e.json().catch(()=>({}));if(!e.ok)return void alert(t?.error||"Failed to start next stage.");t?.session_id&&(window.location.href=`/play/game/${t.session_id}`);return}if(!$){console.error("[v0] Missing selectedSubject"),alert("Unable to start new game. Please try again.");return}let e=await fetch("/api/game/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subject_id:$,difficulty:_,is_demo:!1})}),t=await e.json().catch(()=>({}));if(!e.ok)return void alert(t?.error||"Failed to start new game. Please try again.");t?.session_id?window.location.href=`/play/game/${t.session_id}`:alert("Failed to start new game. Please try again.")}catch(e){console.error("[v0] Error in Play Again:",e),alert("An error occurred. Please try again.")}},children:[(0,t.jsx)(h.Play,{className:"mr-2 h-5 w-5"}),L?D?`Start ${D}`:"Start Next Stage":"Play Again"]}),(0,t.jsx)(s.Button,{variant:"outline",className:"w-full bg-transparent border-2 border-emerald-500 text-emerald-300 hover:bg-emerald-600 hover:text-white hover:border-emerald-600 transition-all duration-200 py-6 text-lg font-semibold",onClick:()=>U.push("/play/dashboard"),children:"Back to Play Mode"})]})]})]})]})}let V=x[p],X=(p+1)/x.length*100,q=V.word.split("").map((e,t)=>V.missingIndex.includes(t)?"_":e);return(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-emerald-900 via-teal-800 to-blue-900 p-4 sm:p-6",children:(0,t.jsxs)("div",{className:"container mx-auto max-w-4xl py-6 sm:py-8",children:[(0,t.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,t.jsxs)(s.Button,{variant:"ghost",className:"text-white hover:bg-white/10",onClick:()=>U.push("/play/dashboard"),children:[(0,t.jsx)(i.ArrowLeft,{className:"mr-2 h-4 w-4"}),"Back"]})}),(0,t.jsxs)("div",{className:"flex gap-2 sm:gap-3 mb-6 flex-wrap",children:[(0,t.jsx)("div",{className:"px-3 sm:px-4 py-2 bg-emerald-800/50 backdrop-blur-sm border border-emerald-700 rounded-lg flex items-center gap-2",children:(0,t.jsx)("span",{className:"text-xs text-emerald-200 uppercase font-semibold",children:_})}),(0,t.jsxs)("div",{className:"px-3 sm:px-4 py-2 bg-teal-800/50 backdrop-blur-sm border border-teal-700 rounded-lg flex items-center gap-2",children:[(0,t.jsx)(o.Timer,{className:"w-3 h-3 sm:w-4 sm:h-4 text-teal-200"}),(0,t.jsxs)("span",{className:"text-white font-mono text-xs sm:text-sm",children:[Math.floor(T/60),":",(T%60).toString().padStart(2,"0")]})]}),(0,t.jsxs)("div",{className:"px-3 sm:px-4 py-2 bg-blue-800/50 backdrop-blur-sm border border-blue-700 rounded-lg flex items-center gap-2",children:[(0,t.jsx)(d.Hash,{className:"w-3 h-3 sm:w-4 sm:h-4 text-blue-200"}),(0,t.jsxs)("span",{className:"text-white font-mono text-xs sm:text-sm",children:["#",A]})]}),(0,t.jsxs)("div",{className:"px-3 sm:px-4 py-2 bg-yellow-800/50 backdrop-blur-sm border border-yellow-700 rounded-lg flex items-center gap-2",children:[(0,t.jsx)(c.Trophy,{className:"w-3 h-3 sm:w-4 sm:h-4 text-yellow-400"}),(0,t.jsxs)("span",{className:"text-white font-mono text-xs sm:text-sm",children:[v," pts"]})]})]}),(0,t.jsxs)("div",{className:"mb-6 sm:mb-8",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,t.jsx)("span",{className:"text-white font-semibold text-sm sm:text-base",children:"Progress"}),(0,t.jsxs)("span",{className:"text-white font-mono text-sm sm:text-base",children:[p+1," / ",x.length]})]}),(0,t.jsx)(n.Progress,{value:X,className:"h-2 bg-slate-800"})]}),(0,t.jsx)(l.Card,{className:"bg-slate-900/90 backdrop-blur-md border-emerald-700",children:(0,t.jsxs)(l.CardContent,{className:"p-4 sm:p-6 md:p-8",children:[(0,t.jsx)("div",{className:"flex justify-center mb-4 sm:mb-6",children:(0,t.jsx)("div",{className:"w-12 h-12 sm:w-16 sm:h-16 rounded-full bg-gradient-to-br from-emerald-600 to-teal-600 flex items-center justify-center",children:(0,t.jsx)(o.Timer,{className:"w-6 h-6 sm:w-8 sm:h-8 text-white"})})}),(0,t.jsx)("div",{className:"bg-gradient-to-br from-emerald-900/50 to-teal-900/50 backdrop-blur-sm border border-emerald-700 rounded-2xl p-4 sm:p-6 md:p-8 mb-6 sm:mb-8",children:(0,t.jsx)("div",{className:"flex justify-center gap-1 sm:gap-2 text-4xl sm:text-5xl md:text-6xl font-bold text-white tracking-wider",children:q.map((e,a)=>(0,t.jsx)("span",{className:V.missingIndex.includes(a)?"text-cyan-400 underline underline-offset-8":"",children:e},a))})}),(0,t.jsx)("div",{className:"grid grid-cols-2 gap-3 sm:gap-4 mb-4 sm:mb-6",children:V.options.map(e=>{let a=V.missingIndex.map(e=>V.word[e]).join("").toUpperCase(),r=e.toUpperCase()===a;return(0,t.jsx)("button",{onClick:()=>J(e),disabled:!!C,className:`p-5 sm:p-6 rounded-xl text-3xl sm:text-4xl font-bold transition-all border-2 min-h-[60px] sm:min-h-[80px] ${"correct"===C&&r?"bg-green-500/20 border-green-500 text-green-400":"wrong"===C&&!r?"bg-red-500/20 border-red-500 text-red-400 opacity-50":"bg-emerald-800/50 border-emerald-700 text-white hover:bg-emerald-700/50 hover:border-emerald-600 active:scale-95"} ${C?"cursor-not-allowed":"cursor-pointer"}`,children:e},e)})}),(0,t.jsxs)(s.Button,{variant:"ghost",className:"w-full text-teal-300 hover:text-white hover:bg-emerald-800/50",onClick:()=>S(!P),children:[(0,t.jsx)(m.Lightbulb,{className:"w-4 h-4 mr-2"}),P?V.hint:"Show Hint"]})]})})]})})}e.s(["default",()=>x])}]);