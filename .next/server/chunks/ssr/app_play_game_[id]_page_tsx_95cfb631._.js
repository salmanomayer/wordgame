module.exports=[26628,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(40695),f=a.i(3130),g=a.i(2150),h=a.i(210),i=a.i(14753),j=a.i(2835),k=a.i(83077),l=a.i(69439),m=a.i(25015),n=a.i(44783);let o=a=>{(0,n.default)("small"===a?{particleCount:100,spread:70}:{particleCount:200,spread:100})};function p(){let a=(0,d.useParams)(),n=a?.id,[p,q]=(0,c.useState)([]),[r,s]=(0,c.useState)(0),[t,u]=(0,c.useState)(0),[v,w]=(0,c.useState)(null),[x,y]=(0,c.useState)(!1),[z,A]=(0,c.useState)(null),[B,C]=(0,c.useState)(!1),[D,E]=(0,c.useState)(0),F=(()=>{if(!n)return 0;let a=0;for(let b=0;b<n.length;b++)a=(31*a+n.charCodeAt(b))%1e3;return a})(),[G,H]=(0,c.useState)("easy"),[I,J]=(0,c.useState)(!1),[K,L]=(0,c.useState)(null),[M,N]=(0,c.useState)(null),[O,P]=(0,c.useState)(null),[Q,R]=(0,c.useState)(null),S=(0,d.useRouter)(),[T,U]=(0,c.useState)("");(0,c.useEffect)(()=>{(async()=>{try{if(console.log("[v0] Starting game initialization for session:",n),!n||"undefined"===n){console.error("[v0] Invalid session ID:",n),alert("Invalid game session. Please start a new game from the dashboard."),S.push("/play/dashboard");return}let a=await fetch("/api/auth/me");if(!a.ok){alert("You must be logged in to play. Redirecting to login..."),S.push("/play/login");return}let b=await a.json().catch(()=>null),c=b?.player;if(!c)return void S.push("/play/login");if(!c.is_active){alert("Your account is not active. Please contact support."),S.push("/play/login");return}let d=await fetch(`/api/game/session/${encodeURIComponent(n)}`),e=await d.json().catch(()=>null);if(!d.ok){alert(e?.error||"Game session not found. Please start a new game from the dashboard."),S.push("/play/dashboard");return}let f=e?.session??e;if(!f)return void S.push("/play/dashboard");if(console.log("[v0] Game session found and verified:",f),w(f.id),U(f.subject_id),H(f.difficulty),L(f.game_id),f.game_id&&f.stage_id){let a=await fetch(`/api/player/game/${f.game_id}/progress`),b=await a.json().catch(()=>null);if(b&&b.stages){let a=b.stages.find(a=>a.id===f.stage_id);a&&R(a.title)}}let g=new URLSearchParams({subject_id:String(f.subject_id)}),h=await fetch(`/api/words?${g.toString()}`),i=await h.json().catch(()=>[]);if(console.log("[v0] Fetched words:",Array.isArray(i)?i.length:0),!Array.isArray(i)||i.length<5){alert("Not enough words in this category"),S.push("/play/dashboard");return}let j=i.slice().sort(()=>Math.random()-.5).slice(0,5).map(a=>({...a,...function(a,b){let c=a.toUpperCase(),d="easy"===b?1:"medium"===b?2:3;console.log("[v0] Generating puzzle for:",c,"difficulty:",b,"gaps:",d);let e=[];for(;e.length<Math.min(d,c.length);){let a=Math.floor(Math.random()*c.length);e.includes(a)||e.push(a)}let f=e.sort((a,b)=>a-b),g=f.map(a=>c[a]).join("");console.log("[v0] Missing indices:",f,"Correct letters:",g);let h="ABCDEFGHIJKLMNOPQRSTUVWXYZ",i=[];for(;i.length<3;){let a="";for(let b=0;b<d;b++)a+=h[Math.floor(Math.random()*h.length)];a===g||i.includes(a)||i.push(a)}let j=[g,...i].sort(()=>Math.random()-.5);return console.log("[v0] Generated options:",j),{missingIndex:f,options:j}}(a.word,f.difficulty)}));q(j),console.log("[v0] Game initialized successfully with",j.length,"words")}catch(a){console.error("[v0] Unexpected error during game init:",a),alert("An error occurred. Please try again."),S.push("/play/dashboard")}})()},[n,S]),(0,c.useEffect)(()=>{if(I&&!x&&p.length>0){let a=setInterval(()=>E(a=>a+1),1e3);return()=>clearInterval(a)}},[I,x,p]);let V=async a=>{if(z)return;let b=p[r],c=b.missingIndex.map(a=>b.word[a]).join("").toUpperCase(),d=a.toUpperCase()===c;if(d?(u(t+10),A("correct"),o("small")):A("wrong"),v)try{await fetch("/api/game/submit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:v,word_id:b.id,is_correct:d,time_taken:D})})}catch(a){console.error("[v0] Failed to save answer:",a)}setTimeout(()=>{r<p.length-1?(s(r+1),A(null),C(!1)):W(d?t+10:t)},d?1500:500)},W=async a=>{if(v)try{if(await fetch("/api/game/complete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:v,score:a,words_completed:p.length})}),K){let b=await fetch(`/api/player/game/${K}/progress`),c=await b.json().catch(()=>null);if(c&&c.next_stage_id){if(N(c.next_stage_id),c.stages){let a=c.stages.find(a=>a.id===c.next_stage_id);P(a?.title||"Next Stage")}y(!0),o("small")}else if(y(!0),o("large"),50===a){let a=setInterval(()=>o("small"),1e3);setTimeout(()=>clearInterval(a),5e3)}}else if(y(!0),o("large"),50===a){let a=setInterval(()=>o("small"),1e3);setTimeout(()=>clearInterval(a),5e3)}}catch(a){console.error("[v0] Failed to complete game:",a),y(!0)}};if(0===p.length)return(0,b.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-gradient-to-br from-slate-950 via-slate-950 to-slate-950",children:(0,b.jsx)("div",{className:"text-lg text-white",children:"Loading game..."})});if(!I&&p.length>0)return(0,b.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-gradient-to-br from-emerald-900 via-teal-800 to-blue-900 p-4 sm:p-6",children:(0,b.jsxs)(f.Card,{className:"relative w-full max-w-lg bg-gradient-to-b from-slate-900/95 to-slate-950/95 backdrop-blur-xl border border-emerald-500/30 text-white shadow-2xl shadow-emerald-500/10 overflow-hidden",children:[(0,b.jsx)("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-emerald-500 via-teal-400 to-cyan-500"}),(0,b.jsxs)(f.CardHeader,{className:"text-center pt-8 pb-4",children:[(0,b.jsx)("div",{className:"flex justify-center mb-6",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-emerald-400/30 rounded-full blur-2xl scale-150 animate-pulse"}),(0,b.jsx)("div",{className:"relative bg-gradient-to-b from-emerald-300 to-emerald-500 rounded-full p-4 shadow-lg shadow-emerald-500/50",children:(0,b.jsx)(m.Play,{className:"w-16 h-16 sm:w-20 sm:h-20 text-emerald-900 ml-2"})})]})}),(0,b.jsx)(f.CardTitle,{className:"text-2xl sm:text-3xl font-bold bg-gradient-to-r from-emerald-300 via-teal-200 to-cyan-300 bg-clip-text text-transparent mb-2",children:Q||"Ready to Play?"}),(0,b.jsxs)("p",{className:"text-slate-400 text-sm sm:text-base",children:["Game #",F]})]}),(0,b.jsxs)(f.CardContent,{className:"text-center space-y-6 px-6 pb-8",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"bg-slate-800/60 backdrop-blur rounded-xl p-4 border border-slate-700/50",children:[(0,b.jsx)("div",{className:"text-xl font-bold text-emerald-400 capitalize",children:G}),(0,b.jsx)("p",{className:"text-slate-400 text-xs mt-1",children:"Difficulty"})]}),(0,b.jsxs)("div",{className:"bg-slate-800/60 backdrop-blur rounded-xl p-4 border border-slate-700/50",children:[(0,b.jsx)("div",{className:"text-xl font-bold text-cyan-400",children:p.length}),(0,b.jsx)("p",{className:"text-slate-400 text-xs mt-1",children:"Words"})]})]}),(0,b.jsx)(e.Button,{className:"w-full bg-gradient-to-r from-emerald-500 via-teal-500 to-cyan-500 hover:from-emerald-600 hover:via-teal-600 hover:to-cyan-600 text-white font-bold py-6 text-lg rounded-xl shadow-lg shadow-emerald-500/30 transition-all duration-300 hover:scale-[1.02]",onClick:()=>J(!0),children:"Start Game"}),(0,b.jsx)(e.Button,{variant:"ghost",className:"w-full text-slate-400 hover:text-white",onClick:()=>S.push("/play/dashboard"),children:"Cancel"})]})]})});if(x){let a,c,d=50===t,g=["Outstanding Performance!","You're a Word Master!","Brilliant Work!","Exceptional Skills!","Phenomenal Achievement!"],h=g[F%g.length],i=Math.round(t/50*100);return(0,b.jsxs)("div",{className:"flex min-h-screen items-center justify-center bg-gradient-to-br from-slate-950 via-emerald-950 to-teal-950 p-4 sm:p-6 overflow-hidden",children:[(0,b.jsxs)("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[(0,b.jsx)("div",{className:"absolute top-1/4 left-1/4 w-96 h-96 bg-emerald-500/10 rounded-full blur-3xl animate-pulse"}),(0,b.jsx)("div",{className:"absolute bottom-1/4 right-1/4 w-96 h-96 bg-teal-500/10 rounded-full blur-3xl animate-pulse delay-1000"}),(0,b.jsx)("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px] bg-cyan-500/5 rounded-full blur-3xl"})]}),(0,b.jsxs)(f.Card,{className:"relative w-full max-w-lg bg-gradient-to-b from-slate-900/95 to-slate-950/95 backdrop-blur-xl border border-emerald-500/30 text-white shadow-2xl shadow-emerald-500/10 overflow-hidden",children:[(0,b.jsx)("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-emerald-500 via-teal-400 to-cyan-500"}),(0,b.jsxs)(f.CardHeader,{className:"text-center pt-8 pb-4",children:[(0,b.jsx)("div",{className:"flex justify-center mb-6",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-yellow-400/30 rounded-full blur-2xl scale-150 animate-pulse"}),(0,b.jsx)("div",{className:"relative bg-gradient-to-b from-yellow-300 to-yellow-500 rounded-full p-4 shadow-lg shadow-yellow-500/50",children:(0,b.jsx)(k.Trophy,{className:"w-16 h-16 sm:w-20 sm:h-20 text-yellow-900"})}),d&&(0,b.jsx)("div",{className:"absolute -top-2 -right-2 bg-gradient-to-r from-pink-500 to-rose-500 rounded-full px-2 py-1 text-xs font-bold animate-bounce",children:"PERFECT!"})]})}),(0,b.jsx)(f.CardTitle,{className:"text-2xl sm:text-3xl font-bold bg-gradient-to-r from-emerald-300 via-teal-200 to-cyan-300 bg-clip-text text-transparent mb-2",children:M?"Stage Complete!":h}),(0,b.jsx)("p",{className:"text-slate-400 text-sm sm:text-base",children:M?"Great job! Ready for the next challenge?":"Game Complete!"})]}),(0,b.jsxs)(f.CardContent,{className:"text-center space-y-6 px-6 pb-8",children:[(0,b.jsxs)("div",{className:"relative bg-gradient-to-br from-emerald-600 via-emerald-500 to-teal-600 rounded-2xl p-6 shadow-lg shadow-emerald-500/30 overflow-hidden",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA2MCA2MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxnIGZpbGw9IiNmZmYiIGZpbGwtb3BhY2l0eT0iMC4xIj48cGF0aCBkPSJNMzYgMzRoLTJ2LTRoMnY0em0wLTZ2LTRoLTJ2NGgyem0tNiA2aC00djJoNHYtMnptMC02djRoLTR2LTJoMnYtMmgyem0tNi02di0yaDR2LTJoLTR2MmgtMnYyaDJ6Ii8+PC9nPjwvZz48L3N2Zz4=')] opacity-30"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("div",{className:"text-6xl sm:text-7xl font-black text-white mb-1 drop-shadow-lg",children:t}),(0,b.jsx)("p",{className:"text-emerald-100 font-medium text-sm sm:text-base uppercase tracking-wider",children:"Total Points"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,b.jsxs)("div",{className:"bg-slate-800/60 backdrop-blur rounded-xl p-4 border border-slate-700/50 hover:border-emerald-500/50 transition-colors",children:[(0,b.jsxs)("div",{className:"text-xl sm:text-2xl font-bold text-emerald-400",children:[Math.floor(t/10),"/5"]}),(0,b.jsx)("p",{className:"text-slate-400 text-xs sm:text-sm mt-1",children:"Correct"})]}),(0,b.jsxs)("div",{className:"bg-slate-800/60 backdrop-blur rounded-xl p-4 border border-slate-700/50 hover:border-teal-500/50 transition-colors",children:[(0,b.jsx)("div",{className:"text-xl sm:text-2xl font-bold text-teal-400 capitalize",children:G}),(0,b.jsx)("p",{className:"text-slate-400 text-xs sm:text-sm mt-1",children:"Difficulty"})]}),(0,b.jsxs)("div",{className:"bg-slate-800/60 backdrop-blur rounded-xl p-4 border border-slate-700/50 hover:border-cyan-500/50 transition-colors",children:[(0,b.jsx)("div",{className:"text-xl sm:text-2xl font-bold text-cyan-400",children:(a=Math.floor(D/60),c=D%60,a>0?`${a}m ${c}s`:`${c}s`)}),(0,b.jsx)("p",{className:"text-slate-400 text-xs sm:text-sm mt-1",children:"Time"})]})]}),(0,b.jsxs)("div",{className:"bg-slate-800/40 rounded-xl p-4 border border-slate-700/50",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,b.jsx)("span",{className:"text-slate-400 text-sm",children:"Accuracy"}),(0,b.jsxs)("span",{className:"text-emerald-400 font-bold",children:[i,"%"]})]}),(0,b.jsx)("div",{className:"h-3 bg-slate-700/50 rounded-full overflow-hidden",children:(0,b.jsx)("div",{className:"h-full bg-gradient-to-r from-emerald-500 to-teal-400 rounded-full transition-all duration-1000 ease-out",style:{width:`${i}%`}})})]}),d&&(0,b.jsxs)("div",{className:"bg-gradient-to-r from-yellow-500/20 to-amber-500/20 border border-yellow-500/40 rounded-xl p-4 backdrop-blur",children:[(0,b.jsx)("p",{className:"text-yellow-300 font-bold text-lg",children:"Perfect Score!"}),(0,b.jsx)("p",{className:"text-yellow-200/80 text-sm",children:"You got every word right!"})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-3 pt-2",children:[(0,b.jsxs)(e.Button,{className:"w-full bg-gradient-to-r from-emerald-500 via-teal-500 to-cyan-500 hover:from-emerald-600 hover:via-teal-600 hover:to-cyan-600 text-white font-bold py-6 text-lg rounded-xl shadow-lg shadow-emerald-500/30 transition-all duration-300 hover:scale-[1.02] hover:shadow-emerald-500/50",onClick:async()=>{try{if(M){let a=await fetch("/api/game/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({game_id:K,stage_id:M,is_demo:!1})}),b=await a.json().catch(()=>({}));if(!a.ok)return void alert(b?.error||"Failed to start next stage.");b?.session_id&&(window.location.href=`/play/game/${b.session_id}`);return}if(!T){console.error("[v0] Missing selectedSubject"),alert("Unable to start new game. Please try again.");return}let a=await fetch("/api/game/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subject_id:T,difficulty:G,is_demo:!1})}),b=await a.json().catch(()=>({}));if(!a.ok)return void alert(b?.error||"Failed to start new game. Please try again.");b?.session_id?window.location.href=`/play/game/${b.session_id}`:alert("Failed to start new game. Please try again.")}catch(a){console.error("[v0] Error in Play Again:",a),alert("An error occurred. Please try again.")}},children:[(0,b.jsx)(m.Play,{className:"mr-2 h-5 w-5"}),M?O?`Start ${O}`:"Start Next Stage":"Play Again"]}),(0,b.jsx)(e.Button,{variant:"outline",className:"w-full bg-transparent border-2 border-emerald-500 text-emerald-300 hover:bg-emerald-600 hover:text-white hover:border-emerald-600 transition-all duration-200 py-6 text-lg font-semibold",onClick:()=>S.push("/play/dashboard"),children:"Back to Play Mode"})]})]})]})]})}let X=p[r],Y=(r+1)/p.length*100,Z=X.word.split("").map((a,b)=>X.missingIndex.includes(b)?"_":a);return(0,b.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-emerald-900 via-teal-800 to-blue-900 p-4 sm:p-6",children:(0,b.jsxs)("div",{className:"container mx-auto max-w-4xl py-6 sm:py-8",children:[(0,b.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,b.jsxs)(e.Button,{variant:"ghost",className:"text-white hover:bg-white/10",onClick:()=>S.push("/play/dashboard"),children:[(0,b.jsx)(h.ArrowLeft,{className:"mr-2 h-4 w-4"}),"Back"]})}),(0,b.jsxs)("div",{className:"flex gap-2 sm:gap-3 mb-6 flex-wrap",children:[(0,b.jsx)("div",{className:"px-3 sm:px-4 py-2 bg-emerald-800/50 backdrop-blur-sm border border-emerald-700 rounded-lg flex items-center gap-2",children:(0,b.jsx)("span",{className:"text-xs text-emerald-200 uppercase font-semibold",children:G})}),(0,b.jsxs)("div",{className:"px-3 sm:px-4 py-2 bg-teal-800/50 backdrop-blur-sm border border-teal-700 rounded-lg flex items-center gap-2",children:[(0,b.jsx)(i.Timer,{className:"w-3 h-3 sm:w-4 sm:h-4 text-teal-200"}),(0,b.jsxs)("span",{className:"text-white font-mono text-xs sm:text-sm",children:[Math.floor(D/60),":",(D%60).toString().padStart(2,"0")]})]}),(0,b.jsxs)("div",{className:"px-3 sm:px-4 py-2 bg-blue-800/50 backdrop-blur-sm border border-blue-700 rounded-lg flex items-center gap-2",children:[(0,b.jsx)(j.Hash,{className:"w-3 h-3 sm:w-4 sm:h-4 text-blue-200"}),(0,b.jsxs)("span",{className:"text-white font-mono text-xs sm:text-sm",children:["#",F]})]}),(0,b.jsxs)("div",{className:"px-3 sm:px-4 py-2 bg-yellow-800/50 backdrop-blur-sm border border-yellow-700 rounded-lg flex items-center gap-2",children:[(0,b.jsx)(k.Trophy,{className:"w-3 h-3 sm:w-4 sm:h-4 text-yellow-400"}),(0,b.jsxs)("span",{className:"text-white font-mono text-xs sm:text-sm",children:[t," pts"]})]})]}),(0,b.jsxs)("div",{className:"mb-6 sm:mb-8",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,b.jsx)("span",{className:"text-white font-semibold text-sm sm:text-base",children:"Progress"}),(0,b.jsxs)("span",{className:"text-white font-mono text-sm sm:text-base",children:[r+1," / ",p.length]})]}),(0,b.jsx)(g.Progress,{value:Y,className:"h-2 bg-slate-800"})]}),(0,b.jsx)(f.Card,{className:"bg-slate-900/90 backdrop-blur-md border-emerald-700",children:(0,b.jsxs)(f.CardContent,{className:"p-4 sm:p-6 md:p-8",children:[(0,b.jsx)("div",{className:"flex justify-center mb-4 sm:mb-6",children:(0,b.jsx)("div",{className:"w-12 h-12 sm:w-16 sm:h-16 rounded-full bg-gradient-to-br from-emerald-600 to-teal-600 flex items-center justify-center",children:(0,b.jsx)(i.Timer,{className:"w-6 h-6 sm:w-8 sm:h-8 text-white"})})}),(0,b.jsx)("div",{className:"bg-gradient-to-br from-emerald-900/50 to-teal-900/50 backdrop-blur-sm border border-emerald-700 rounded-2xl p-4 sm:p-6 md:p-8 mb-6 sm:mb-8",children:(0,b.jsx)("div",{className:"flex justify-center gap-1 sm:gap-2 text-4xl sm:text-5xl md:text-6xl font-bold text-white tracking-wider",children:Z.map((a,c)=>(0,b.jsx)("span",{className:X.missingIndex.includes(c)?"text-cyan-400 underline underline-offset-8":"",children:a},c))})}),(0,b.jsx)("div",{className:"grid grid-cols-2 gap-3 sm:gap-4 mb-4 sm:mb-6",children:X.options.map(a=>{let c=X.missingIndex.map(a=>X.word[a]).join("").toUpperCase(),d=a.toUpperCase()===c;return(0,b.jsx)("button",{onClick:()=>V(a),disabled:!!z,className:`p-5 sm:p-6 rounded-xl text-3xl sm:text-4xl font-bold transition-all border-2 min-h-[60px] sm:min-h-[80px] ${"correct"===z&&d?"bg-green-500/20 border-green-500 text-green-400":"wrong"===z&&!d?"bg-red-500/20 border-red-500 text-red-400 opacity-50":"bg-emerald-800/50 border-emerald-700 text-white hover:bg-emerald-700/50 hover:border-emerald-600 active:scale-95"} ${z?"cursor-not-allowed":"cursor-pointer"}`,children:a},a)})}),(0,b.jsxs)(e.Button,{variant:"ghost",className:"w-full text-teal-300 hover:text-white hover:bg-emerald-800/50",onClick:()=>C(!B),children:[(0,b.jsx)(l.Lightbulb,{className:"w-4 h-4 mr-2"}),B?X.hint:"Show Hint"]})]})})]})})}a.s(["default",()=>p])}];

//# sourceMappingURL=app_play_game_%5Bid%5D_page_tsx_95cfb631._.js.map