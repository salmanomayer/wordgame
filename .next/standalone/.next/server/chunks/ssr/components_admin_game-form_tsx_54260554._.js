module.exports=[29217,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(40695),f=a.i(5522),g=a.i(17171),h=a.i(3130),i=a.i(70121),j=a.i(50104),k=a.i(7554),l=a.i(25152),m=a.i(77994),n=a.i(3688),o=a.i(77192),p=a.i(30553),q="Checkbox",[r,s]=(0,j.createContextScope)(q),[t,u]=r(q),v=c.forwardRef((a,d)=>{let{__scopeCheckbox:e,name:f,checked:g,defaultChecked:h,required:j,disabled:m,value:n="on",onCheckedChange:o,form:q,...r}=a,[s,u]=c.useState(null),v=(0,i.useComposedRefs)(d,a=>u(a)),w=c.useRef(!1),x=!s||q||!!s.closest("form"),[B=!1,C]=(0,l.useControllableState)({prop:g,defaultProp:h,onChange:o}),D=c.useRef(B);return c.useEffect(()=>{let a=s?.form;if(a){let b=()=>C(D.current);return a.addEventListener("reset",b),()=>a.removeEventListener("reset",b)}},[s,C]),(0,b.jsxs)(t,{scope:e,state:B,disabled:m,children:[(0,b.jsx)(p.Primitive.button,{type:"button",role:"checkbox","aria-checked":z(B)?"mixed":B,"aria-required":j,"data-state":A(B),"data-disabled":m?"":void 0,disabled:m,value:n,...r,ref:v,onKeyDown:(0,k.composeEventHandlers)(a.onKeyDown,a=>{"Enter"===a.key&&a.preventDefault()}),onClick:(0,k.composeEventHandlers)(a.onClick,a=>{C(a=>!!z(a)||!a),x&&(w.current=a.isPropagationStopped(),w.current||a.stopPropagation())})}),x&&(0,b.jsx)(y,{control:s,bubbles:!w.current,name:f,value:n,checked:B,required:j,disabled:m,form:q,style:{transform:"translateX(-100%)"},defaultChecked:!z(h)&&h})]})});v.displayName=q;var w="CheckboxIndicator",x=c.forwardRef((a,c)=>{let{__scopeCheckbox:d,forceMount:e,...f}=a,g=u(w,d);return(0,b.jsx)(o.Presence,{present:e||z(g.state)||!0===g.state,children:(0,b.jsx)(p.Primitive.span,{"data-state":A(g.state),"data-disabled":g.disabled?"":void 0,...f,ref:c,style:{pointerEvents:"none",...a.style}})})});x.displayName=w;var y=a=>{let{control:d,checked:e,bubbles:f=!0,defaultChecked:g,...h}=a,i=c.useRef(null),j=(0,m.usePrevious)(e),k=(0,n.useSize)(d);c.useEffect(()=>{let a=i.current,b=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(j!==e&&b){let c=new Event("click",{bubbles:f});a.indeterminate=z(e),b.call(a,!z(e)&&e),a.dispatchEvent(c)}},[j,e,f]);let l=c.useRef(!z(e)&&e);return(0,b.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:g??l.current,...h,tabIndex:-1,ref:i,style:{...a.style,...k,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function z(a){return"indeterminate"===a}function A(a){return z(a)?"indeterminate":a?"checked":"unchecked"}var B=a.i(6406),C=a.i(97895);function D({className:a,...c}){return(0,b.jsx)(v,{"data-slot":"checkbox",className:(0,C.cn)("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",a),...c,children:(0,b.jsx)(x,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:(0,b.jsx)(B.CheckIcon,{className:"size-3.5"})})})}var E=a.i(15618),F=a.i(81560);let G=(0,a.i(70106).default)("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);var H=a.i(92e3),I=a.i(77687),J=a.i(80281);function K({initialData:a,isEdit:i}){let[j,k]=(0,c.useState)([]),[l,m]=(0,c.useState)(!1),[n,o]=(0,c.useState)(a?.title||""),[p,q]=(0,c.useState)(a?.start_time?new Date(a.start_time).toISOString().slice(0,16):""),[r,s]=(0,c.useState)(a?.end_time?new Date(a.end_time).toISOString().slice(0,16):""),[t,u]=(0,c.useState)(a?.correct_marks||10),[v,w]=(0,c.useState)(a?.time_per_word||30),[x,y]=(0,c.useState)(a?.word_count||5),[z,A]=(0,c.useState)(a?.difficulty||"medium"),[B,C]=(0,c.useState)(a?.is_active===void 0||a.is_active),[K,L]=(0,c.useState)(Array.isArray(a?.subjects)?a.subjects:[]),[M,N]=(0,c.useState)(Array.isArray(a?.stages)?a.stages:[]),[O,P]=(0,c.useState)(Array.isArray(a?.stages)&&a.stages.length>0),Q=(0,d.useRouter)(),{toast:R}=(0,I.useToast)();(0,c.useEffect)(()=>{(async()=>{let a=localStorage.getItem("admin_token");try{let b=await fetch("/api/admin/subjects",{headers:{Authorization:`Bearer ${a}`}}),c=await b.json();k(Array.isArray(c)?c:[])}catch(a){console.error("Failed to fetch subjects",a),k([])}})()},[]);let S=(a,b,c)=>{let d=[...M];d[a]={...d[a],[b]:c},N(d)},T=(a,b)=>{if("game"===b)L(b=>b.includes(a)?b.filter(b=>b!==a):[...b,a]);else{let c=[...M],d=c[b].subjects;c[b].subjects=d.includes(a)?d.filter(b=>b!==a):[...d,a],N(c)}},U=async b=>{if(b.preventDefault(),!n||!t)return void R({variant:"destructive",title:"Validation Error",description:"Title and marks are mandatory."});m(!0);let c=localStorage.getItem("admin_token"),d={title:n,start_time:p||null,end_time:r||null,correct_marks:Number(t),time_per_word:Number(v),word_count:Number(x),difficulty:z,is_active:B,subjects:O?[]:K,stages:O?M:[]};try{let b=i?`/api/admin/games/${a.id}`:"/api/admin/games",e=await fetch(b,{method:i?"PATCH":"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},body:JSON.stringify(d)});if(!e.ok){let a=await e.json();throw Error(a.error||"Failed to save game")}R({title:"Success",description:`Game ${i?"updated":"created"} successfully.`}),Q.push("/admin/games")}catch(a){R({variant:"destructive",title:"Error",description:a.message})}finally{m(!1)}};return(0,b.jsxs)("form",{onSubmit:U,className:"space-y-8 max-w-4xl mx-auto pb-12",children:[(0,b.jsxs)(h.Card,{children:[(0,b.jsxs)(h.CardHeader,{children:[(0,b.jsx)(h.CardTitle,{children:i?"Edit Game":"Create New Game"}),(0,b.jsx)(h.CardDescription,{children:"Configure basic game settings and rules."})]}),(0,b.jsxs)(h.CardContent,{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"title",children:"Game Title *"}),(0,b.jsx)(f.Input,{id:"title",value:n,onChange:a=>o(a.target.value),placeholder:"e.g. Weekly Challenge #1",required:!0})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2 sm:pt-8",children:[(0,b.jsx)(J.Switch,{id:"active",checked:B,onCheckedChange:C}),(0,b.jsx)(g.Label,{htmlFor:"active",children:"Game Active"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"marks",children:"Correct Answer Marks *"}),(0,b.jsx)(f.Input,{id:"marks",type:"number",value:t,onChange:a=>u(a.target.value),required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"time",children:"Time per Word (seconds)"}),(0,b.jsx)(f.Input,{id:"time",type:"number",value:v,onChange:a=>w(a.target.value)})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"start",children:"Start Date & Time (Optional)"}),(0,b.jsx)(f.Input,{id:"start",type:"datetime-local",value:p,onChange:a=>q(a.target.value)})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"end",children:"End Date & Time (Optional)"}),(0,b.jsx)(f.Input,{id:"end",type:"datetime-local",value:r,onChange:a=>s(a.target.value)})]})]})]})]}),(0,b.jsxs)(h.Card,{children:[(0,b.jsx)(h.CardHeader,{children:(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(h.CardTitle,{children:"Game Structure"}),(0,b.jsx)(h.CardDescription,{children:O?"Configure multiple stages for this game.":"Select subjects for a single-level game."})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(g.Label,{htmlFor:"has-stages",children:"Enable Stages"}),(0,b.jsx)(J.Switch,{id:"has-stages",checked:O,onCheckedChange:P})]})]})}),(0,b.jsx)(h.CardContent,{className:"space-y-6",children:O?(0,b.jsxs)("div",{className:"space-y-6",children:[M.map((a,c)=>(0,b.jsxs)("div",{className:"relative border rounded-lg p-4 bg-muted/30 space-y-4",children:[(0,b.jsxs)("div",{className:"flex justify-between items-start",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(G,{className:"h-5 w-5 text-muted-foreground"}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsxs)(g.Label,{children:["Stage ",c+1," Title"]}),(0,b.jsx)(f.Input,{value:a.title,onChange:a=>S(c,"title",a.target.value),className:"h-8 w-64"})]})]}),(0,b.jsx)(e.Button,{variant:"ghost",size:"icon",className:"text-destructive",onClick:()=>{N(M.filter((a,b)=>b!==c))},children:(0,b.jsx)(F.Trash2,{className:"h-4 w-4"})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{className:"text-xs",children:"Word Count"}),(0,b.jsx)(f.Input,{type:"number",value:a.word_count,onChange:a=>S(c,"word_count",a.target.value),className:"h-8"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{className:"text-xs",children:"Difficulty"}),(0,b.jsxs)("select",{value:a.difficulty,onChange:a=>S(c,"difficulty",a.target.value),className:"flex h-8 w-full rounded-md border border-input bg-background px-3 py-1 text-xs ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:[(0,b.jsx)("option",{value:"easy",children:"Easy"}),(0,b.jsx)("option",{value:"medium",children:"Medium"}),(0,b.jsx)("option",{value:"hard",children:"Hard"})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{className:"text-xs",children:"Stage Subjects"}),(0,b.jsx)("div",{className:"border rounded-md p-3 max-h-40 overflow-y-auto bg-background",children:j.map(d=>(0,b.jsxs)("div",{className:"flex items-center space-x-2 py-1",children:[(0,b.jsx)(D,{id:`stage-${c}-subject-${d.id}`,checked:a.subjects.includes(d.id),onCheckedChange:()=>T(d.id,c)}),(0,b.jsx)(g.Label,{htmlFor:`stage-${c}-subject-${d.id}`,className:"text-xs font-normal cursor-pointer",children:d.name})]},d.id))})]})]})]},c)),(0,b.jsxs)(e.Button,{type:"button",variant:"outline",className:"w-full border-dashed",onClick:()=>{N([...M,{title:`Stage ${M.length+1}`,subjects:[],word_count:5,difficulty:"medium"}])},children:[(0,b.jsx)(E.Plus,{className:"mr-2 h-4 w-4"})," Add Stage"]})]}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"game-word-count",children:"Number of Words to Play"}),(0,b.jsx)(f.Input,{id:"game-word-count",type:"number",value:x,onChange:a=>y(a.target.value),min:"1"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"game-difficulty",children:"Difficulty"}),(0,b.jsxs)("select",{id:"game-difficulty",value:z,onChange:a=>A(a.target.value),className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:[(0,b.jsx)("option",{value:"easy",children:"Easy"}),(0,b.jsx)("option",{value:"medium",children:"Medium"}),(0,b.jsx)("option",{value:"hard",children:"Hard"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(g.Label,{children:"Select Subjects"}),(0,b.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3 border rounded-md p-4 max-h-60 overflow-y-auto",children:j.map(a=>(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(D,{id:`subject-${a.id}`,checked:K.includes(a.id),onCheckedChange:()=>T(a.id,"game")}),(0,b.jsx)(g.Label,{htmlFor:`subject-${a.id}`,className:"text-sm font-normal cursor-pointer",children:a.name})]},a.id))}),0===K.length&&(0,b.jsxs)("p",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[(0,b.jsx)(H.AlertCircle,{className:"h-3 w-3"})," Please select at least one subject."]})]})]})})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,b.jsx)(e.Button,{type:"button",variant:"outline",onClick:()=>Q.push("/admin/games"),children:"Cancel"}),(0,b.jsx)(e.Button,{type:"submit",disabled:l,children:l?"Saving...":i?"Update Game":"Create Game"})]})]})}a.s(["GameForm",()=>K],29217)}];

//# sourceMappingURL=components_admin_game-form_tsx_54260554._.js.map