module.exports=[48967,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(67301),f=a.i(14727),g=a.i(88237),h=a.i(3130),i=a.i(40695),j=a.i(81560),k=a.i(24569),l=a.i(15618);let m=(0,a.i(70106).default)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);var n=a.i(54161),o=a.i(65733),p=a.i(5522),q=a.i(17171),r=a.i(97895);function s({className:a,...c}){return(0,b.jsx)("textarea",{"data-slot":"textarea",className:(0,r.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),...c})}var t=a.i(80281);function u({open:a,onOpenChange:d,subject:e,onSuccess:f}){let[g,h]=(0,c.useState)(""),[j,k]=(0,c.useState)(""),[l,m]=(0,c.useState)(!0),[n,r]=(0,c.useState)(!1);(0,c.useEffect)(()=>{e?(h(e.name),k(e.description),m(e.is_active)):(h(""),k(""),m(!0))},[e,a]);let u=async a=>{a.preventDefault(),r(!0);let b=localStorage.getItem("admin_token");try{let a=e?`/api/admin/subjects/${e.id}`:"/api/admin/subjects",c=e?"PUT":"POST";if(!(await fetch(a,{method:c,headers:{"Content-Type":"application/json",Authorization:`Bearer ${b}`},body:JSON.stringify({name:g,description:j,is_active:l})})).ok)throw Error("Failed to save subject");f(),d(!1)}catch(a){console.error("Error saving subject:",a),alert("Failed to save subject")}finally{r(!1)}};return(0,b.jsx)(o.Dialog,{open:a,onOpenChange:d,children:(0,b.jsxs)(o.DialogContent,{children:[(0,b.jsx)(o.DialogHeader,{children:(0,b.jsx)(o.DialogTitle,{children:e?"Edit Subject":"Add Subject"})}),(0,b.jsxs)("form",{onSubmit:u,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(q.Label,{htmlFor:"name",children:"Subject Name"}),(0,b.jsx)(p.Input,{id:"name",value:g,onChange:a=>h(a.target.value),required:!0,placeholder:"e.g., Animals, Science, Geography"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(q.Label,{htmlFor:"description",children:"Description"}),(0,b.jsx)(s,{id:"description",value:j,onChange:a=>k(a.target.value),placeholder:"Brief description of this subject category"})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(q.Label,{htmlFor:"active",children:"Active"}),(0,b.jsx)(t.Switch,{id:"active",checked:l,onCheckedChange:m})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)(i.Button,{type:"button",variant:"outline",onClick:()=>d(!1),children:"Cancel"}),(0,b.jsx)(i.Button,{type:"submit",disabled:n,children:n?"Saving...":"Save"})]})]})]})})}function v({open:a,onOpenChange:d,onSuccess:e,subjectId:f}){let[g,h]=(0,c.useState)(null),[j,k]=(0,c.useState)(!1),[l,n]=(0,c.useState)(null),r=async()=>{if(!g)return;k(!0),n(null);let a=localStorage.getItem("admin_token"),b=new FormData;b.append("file",g),f&&b.append("subject_id",f);try{let c,f=await fetch("/api/admin/words/bulk-upload",{method:"POST",headers:{Authorization:`Bearer ${a}`},body:b});try{c=await f.json()}catch(a){throw Error("Server returned an invalid response. Please check if the file is too large or incorrectly formatted.")}if(!f.ok)throw Error(c.error||"Upload failed");e(),d(!1),h(null)}catch(a){n(a instanceof Error?a.message:"Upload failed")}finally{k(!1)}};return(0,b.jsx)(o.Dialog,{open:a,onOpenChange:d,children:(0,b.jsxs)(o.DialogContent,{children:[(0,b.jsx)(o.DialogHeader,{children:(0,b.jsxs)(o.DialogTitle,{children:["Bulk Upload Words ",f?"(Selected Subject)":""]})}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(q.Label,{children:"Upload CSV file"}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground space-y-1",children:[(0,b.jsxs)("p",{className:"font-semibold",children:["File format: ",f?"difficulty, word, hint":"subject_name, difficulty, word, hint"]}),(0,b.jsx)("div",{className:"bg-muted p-2 rounded font-mono text-xs space-y-1",children:f?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("p",{children:"Easy, CAT, A furry pet that says meow"}),(0,b.jsx)("p",{children:"Hard, PHOTOSYNTHESIS, Plants make food using sunlight"}),(0,b.jsx)("p",{children:"Medium, NEBULA, Cloud of gas and dust in space"}),(0,b.jsx)("p",{children:"MOUNTAIN, A large natural elevation (Default Medium)"})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("p",{children:"Animals, Easy, CAT, A furry pet that says meow"}),(0,b.jsx)("p",{children:"Science, Hard, PHOTOSYNTHESIS, Plants make food using sunlight"}),(0,b.jsx)("p",{children:"Space, Medium, NEBULA, Cloud of gas and dust in space"}),(0,b.jsx)("p",{children:"Geography, Medium, MOUNTAIN, A large natural elevation"})]})}),(0,b.jsxs)("p",{className:"text-xs mt-2",children:["Supported formats:",f?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("br",{}),"• 3 columns: difficulty, word, hint",(0,b.jsx)("br",{}),"• 2 columns: word, hint (default: medium)",(0,b.jsx)("br",{}),"• 1 column: word (default: medium, no hint)"]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("br",{}),"• 4 columns: subject, difficulty, word, hint",(0,b.jsx)("br",{}),"• 3 columns: subject, word, hint (default: medium)",(0,b.jsx)("br",{}),"• 2 columns: subject, word (default: medium, no hint)"]})]}),!f&&(0,b.jsx)("p",{className:"text-xs mt-2",children:"Each row creates a word under the specified subject. Subjects are auto-created if they don't exist."})]}),(0,b.jsx)(p.Input,{type:"file",accept:".csv",onChange:a=>{let b=a.target.files?.[0];if(b){if(!b.name.endsWith(".csv")){n("Please upload a CSV file. Excel files (.xlsx) are not supported yet."),h(null);return}h(b),n(null)}}})]}),l&&(0,b.jsx)("p",{className:"text-sm text-destructive",children:l}),(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)(i.Button,{type:"button",variant:"outline",onClick:()=>d(!1),children:"Cancel"}),(0,b.jsxs)(i.Button,{onClick:r,disabled:!g||j,children:[(0,b.jsx)(m,{className:"mr-2 h-4 w-4"}),j?"Uploading...":"Upload"]})]})]})]})})}function w({open:a,onOpenChange:d,subjectId:e}){let[f,h]=(0,c.useState)([]),[k,n]=(0,c.useState)(""),[r,s]=(0,c.useState)(""),[t,u]=(0,c.useState)(!1),[w,x]=(0,c.useState)(!1),y=(0,c.useCallback)(async()=>{let a=localStorage.getItem("admin_token");try{let b=await fetch(`/api/admin/words?subject_id=${e}`,{headers:{Authorization:`Bearer ${a}`}});if(!b.ok){let a=await b.json().catch(()=>({}));throw Error(a.error||"Failed to fetch words")}let c=await b.json();h(Array.isArray(c)?c:[])}catch(a){console.error("[v0] Error fetching words:",a),h([])}},[e]);(0,c.useEffect)(()=>{a&&y()},[a,y]);let z=async a=>{a.preventDefault(),u(!0);let b=localStorage.getItem("admin_token");try{if(!(await fetch("/api/admin/words",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${b}`},body:JSON.stringify({word:k.toUpperCase(),hint:r,subject_id:e})})).ok)throw Error("Failed to add word");n(""),s(""),y()}catch(a){console.error("[v0] Error adding word:",a),alert("Failed to add word")}finally{u(!1)}},A=async a=>{let b=localStorage.getItem("admin_token");try{if(!(await fetch(`/api/admin/words/${a}`,{method:"DELETE",headers:{Authorization:`Bearer ${b}`}})).ok)throw Error("Failed to delete word");h(f.filter(b=>b.id!==a))}catch(a){console.error("[v0] Error deleting word:",a),alert("Failed to delete word")}};return(0,b.jsxs)(o.Dialog,{open:a,onOpenChange:d,children:[(0,b.jsxs)(o.DialogContent,{className:"max-w-3xl max-h-[80vh] overflow-y-auto",children:[(0,b.jsx)(o.DialogHeader,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(o.DialogTitle,{children:"Manage Words"}),(0,b.jsxs)(i.Button,{variant:"outline",size:"sm",onClick:()=>x(!0),children:[(0,b.jsx)(m,{className:"mr-2 h-4 w-4"}),"Bulk Upload"]})]})}),(0,b.jsxs)("form",{onSubmit:z,className:"space-y-4 border-b pb-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(q.Label,{htmlFor:"word",children:"Word"}),(0,b.jsx)(p.Input,{id:"word",value:k,onChange:a=>n(a.target.value),placeholder:"Enter word",required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(q.Label,{htmlFor:"hint",children:"Hint"}),(0,b.jsx)(p.Input,{id:"hint",value:r,onChange:a=>s(a.target.value),placeholder:"Enter hint"})]})]}),(0,b.jsxs)(i.Button,{type:"submit",disabled:t,className:"w-full",children:[(0,b.jsx)(l.Plus,{className:"mr-2 h-4 w-4"}),t?"Adding...":"Add Word"]})]}),(0,b.jsx)("div",{children:(0,b.jsxs)(g.Table,{children:[(0,b.jsx)(g.TableHeader,{children:(0,b.jsxs)(g.TableRow,{children:[(0,b.jsx)(g.TableHead,{children:"Word"}),(0,b.jsx)(g.TableHead,{children:"Hint"}),(0,b.jsx)(g.TableHead,{className:"text-right",children:"Actions"})]})}),(0,b.jsx)(g.TableBody,{children:0===f.length?(0,b.jsx)(g.TableRow,{children:(0,b.jsx)(g.TableCell,{colSpan:3,className:"text-center",children:"No words found"})}):f.map(a=>(0,b.jsxs)(g.TableRow,{children:[(0,b.jsx)(g.TableCell,{className:"font-medium",children:a.word}),(0,b.jsx)(g.TableCell,{children:a.hint}),(0,b.jsx)(g.TableCell,{className:"text-right",children:(0,b.jsx)(i.Button,{variant:"destructive",size:"sm",onClick:()=>A(a.id),children:(0,b.jsx)(j.Trash2,{className:"h-4 w-4"})})})]},a.id))})]})})]}),(0,b.jsx)(v,{open:w,onOpenChange:x,onSuccess:y,subjectId:e})]})}var x=a.i(1549);function y(){let[a,o]=(0,c.useState)([]),[p,q]=(0,c.useState)(!0),[r,s]=(0,c.useState)(null),[t,y]=(0,c.useState)(!1),[z,A]=(0,c.useState)(null),[B,C]=(0,c.useState)(!1),[D,E]=(0,c.useState)(!1),F=(0,d.useRouter)(),G=(0,c.useCallback)(async()=>{let a=localStorage.getItem("admin_token");if(!a)return void F.push("/admin/login");try{let b=await fetch("/api/admin/subjects",{headers:{Authorization:`Bearer ${a}`}});if(!b.ok)throw Error("Failed to fetch subjects");let c=await b.json();Array.isArray(c)?o(c):(console.error("[v0] API returned non-array data:",c),o([]))}catch(a){console.error("[v0] Error fetching subjects:",a),o([])}finally{q(!1)}},[F]);(0,c.useEffect)(()=>{G()},[G]);let H=async b=>{if(!confirm("Are you sure? This will delete all associated words."))return;let c=localStorage.getItem("admin_token");try{if(!(await fetch(`/api/admin/subjects/${b}`,{method:"DELETE",headers:{Authorization:`Bearer ${c}`}})).ok)throw Error("Failed to delete subject");o(a.filter(a=>a.id!==b))}catch(a){console.error("[v0] Error deleting subject:",a),alert("Failed to delete subject")}};return p?(0,b.jsxs)(f.SidebarProvider,{children:[(0,b.jsx)(e.AdminNav,{}),(0,b.jsxs)(f.SidebarInset,{className:"bg-muted/40",children:[(0,b.jsxs)("header",{className:"flex h-16 items-center gap-2 border-b bg-background px-4",children:[(0,b.jsx)(f.SidebarTrigger,{}),(0,b.jsx)("h2",{className:"text-lg font-semibold",children:"Subjects"})]}),(0,b.jsx)("div",{className:"flex min-h-[calc(100svh-4rem)] items-center justify-center",children:(0,b.jsx)("div",{className:"text-lg",children:"Loading..."})})]})]}):(0,b.jsxs)(f.SidebarProvider,{children:[(0,b.jsx)(e.AdminNav,{}),(0,b.jsxs)(f.SidebarInset,{className:"min-w-0 bg-muted/40",children:[(0,b.jsxs)("header",{className:"flex h-16 items-center gap-2 border-b bg-background px-4",children:[(0,b.jsx)(f.SidebarTrigger,{}),(0,b.jsx)("h2",{className:"text-lg font-semibold",children:"Subjects"})]}),(0,b.jsxs)("div",{className:"p-4 sm:p-6",children:[(0,b.jsxs)(h.Card,{children:[(0,b.jsxs)(h.CardHeader,{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[(0,b.jsx)(h.CardTitle,{children:"Subject Management"}),(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2 w-full sm:w-auto",children:[(0,b.jsxs)(i.Button,{onClick:()=>E(!0),variant:"outline",className:"w-full sm:w-auto",children:[(0,b.jsx)(m,{className:"mr-2 h-4 w-4"}),"Bulk Upload"]}),(0,b.jsxs)(i.Button,{className:"w-full sm:w-auto",onClick:()=>{s(null),y(!0)},children:[(0,b.jsx)(l.Plus,{className:"mr-2 h-4 w-4"}),"Add Subject"]})]})]}),(0,b.jsx)(h.CardContent,{children:(0,b.jsx)("div",{className:"w-full overflow-x-auto rounded-md border",children:(0,b.jsxs)(g.Table,{children:[(0,b.jsx)(g.TableHeader,{children:(0,b.jsxs)(g.TableRow,{children:[(0,b.jsx)(g.TableHead,{className:"whitespace-nowrap",children:"Name"}),(0,b.jsx)(g.TableHead,{className:"whitespace-nowrap",children:"Description"}),(0,b.jsx)(g.TableHead,{className:"whitespace-nowrap",children:"Status"}),(0,b.jsx)(g.TableHead,{className:"text-right whitespace-nowrap",children:"Actions"})]})}),(0,b.jsx)(g.TableBody,{children:0===a.length?(0,b.jsx)(g.TableRow,{children:(0,b.jsx)(g.TableCell,{colSpan:4,className:"text-center",children:"No subjects found"})}):a.map(a=>(0,b.jsxs)(g.TableRow,{children:[(0,b.jsx)(g.TableCell,{className:"font-medium whitespace-nowrap",children:a.name}),(0,b.jsx)(g.TableCell,{className:"whitespace-nowrap",children:a.description}),(0,b.jsx)(g.TableCell,{className:"whitespace-nowrap",children:(0,b.jsx)(n.Badge,{variant:a.is_active?"default":"secondary",children:a.is_active?"Active":"Inactive"})}),(0,b.jsx)(g.TableCell,{className:"text-right whitespace-nowrap",children:(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)(i.Button,{variant:"outline",size:"sm",onClick:()=>{A(a.id),C(!0)},children:"Words"}),(0,b.jsx)(i.Button,{variant:"outline",size:"sm",onClick:()=>{s(a),y(!0)},children:(0,b.jsx)(k.Edit,{className:"h-4 w-4"})}),(0,b.jsx)(i.Button,{variant:"destructive",size:"sm",onClick:()=>H(a.id),children:(0,b.jsx)(j.Trash2,{className:"h-4 w-4"})})]})})]},a.id))})]})})})]}),(0,b.jsx)(x.AdminFooter,{})]}),(0,b.jsx)(u,{open:t,onOpenChange:y,subject:r,onSuccess:G}),z&&(0,b.jsx)(w,{open:B,onOpenChange:C,subjectId:z}),(0,b.jsx)(v,{open:D,onOpenChange:E,onSuccess:G})]})]})}a.s(["default",()=>y],48967)}];

//# sourceMappingURL=app_admin_subjects_page_tsx_3ab21486._.js.map